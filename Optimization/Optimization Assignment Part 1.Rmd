---
title: "Optimization"
author: "Efthymios Ioannis Kavour"
date: '2022-06-24'
output: 
  pdf_document: 
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(latex2exp)
library(lpSolve)
library(lpSolveAPI)
```

### \underline{Exercise 1}:

Assume that :

$$
A = \begin{bmatrix}
3   &  0    &  3 \\
0   &  1    & -2 \\
3   & -2    &  8 \\
\end{bmatrix}
\quad 
B = \begin{bmatrix}
 2  & -1  &  b   \\
-1  &  2  & -1   \\
 b  & -1  &  2   \\
\end{bmatrix}
$$

Is $\textbf{A}$ positively definite? Are there values of $\textit{b}$
that matrix $\textbf{B}$ is positively definite? If yes what are those
values?

### \underline{Solution}:

We know that a symmetrical matrix $M_{k\times k}\quad k =1,\dots,n$ is positively definite if

1. All the eigen values are positive.
2. All the $\textit{n}$ upper left determinants of a $M_{k\times k}$ are positive
3. All the drivers $d_i,\quad\forall i = 1,\dots,n$ in the Gaussian Elimination without interchanging of lines are positive.\

In order to check whether $A$ is positive definite, we are going to calculate all the upper left determinants. As a result we have the following observations. The first term $m_{1\times 1}$ is positive.

$$
3 > 0
$$

Furthermore, we can see that the next $\textit{left-upper}$ determinant is the determinant of the $2\times 2$ submatrix, as shown below, which is positive as well.

$$
\begin{vmatrix}
3 & 0 \\
0 & 1
\end{vmatrix} = 3 > 0
$$
Finally what is left is the determinant of the full $3\times 3$ matrix $A$ which as shown below, positive.


$$
\begin{vmatrix}
3   &  0    &  3    \\
0   &  1    & -2    \\
3   & -2    &  8    
\end{vmatrix} = \\
$$
$$
3\cdot1\cdot8+0\cdot(-2)\cdot3+3\cdot0\cdot(-2)-3\cdot1\cdot3-(-2)\cdot(-2)\cdot3-8\cdot0\cdot0=\\
$$

$$
24+0+0-9-12-0=3>0
$$

In conclusion, we can see that matrix $A$ is $\textbf{positive define}$. We are going to follow the exact same methodology in order to answer to the second part of this exercise. Initially we observe that $2>0$ and as a result we move forward and calculate the next determinant of the upper-left submatrix $M_{2\times2}$.

$$
\begin{vmatrix}
 2 &  -1 \\
-1 & 2 
\end{vmatrix} = 2\cdot 2 - (-1)\cdot (-1)= 4 - 1 = 3 >0
$$ 
The determinant of the submatrix is a positive number. What is left is to calculate the determinant of the full initial matrix, containing the unknown $b$. What we need is $B$ to be a positive definite. This means that: 

$$
\begin{vmatrix}
 2  & -1  &  b   \\
-1  &  2  & -1   \\
 b  & -1  &  2  
\end{vmatrix}=
$$

$$
2\cdot 2\cdot 2 + (-1)\cdot (-1)\cdot b + b\cdot (-1)\cdot (-1) - b \cdot 2\cdot b- (-1)\cdot (-1)\cdot 2 - 2 \cdot (-1)\cdot (-1)=
$$

$$
8+b+b-2b^2-2-2=-2b^2+2b+4
$$

As a result we have to find all those $b$ that the equation we ended up. If we follow the usual steps of solving a second order equation we have that:

$$
−2b^2+2b+4=2(−b−1)(b−2)
$$
which means that the $b$ that make this equation equal to zero are $b=-1$ and $b=2$. We know that the equation is going to be positive $\forall b \in (-1,2)$ and negative $\forall b \in (-\infty,-1)\cup(2,\infty)$. This is something one can observe in the following graph.

```{r}
f1 <- function(x){
        return(-2*x^2+2*x+4)
}

curve(expr = f1, from = -2, to = 3)
points(x = c(-1,2), y = c(0,0), col = 'red')
abline(h = 0, lty = 2, col = 'red')
title(main = TeX(r'(\textbf{Equation} : $-2x^2+2x+4$)'))
```

As a result the solution is the following
$$
B\text{ positive-definite} \Leftrightarrow \forall b \in (-1,2)
$$

******

### \underline{Exercise 2}:

Find all the critical points and say whether they are local minimum, local maximum or saddle points, of the following functions:

$$
f(x,y)=x^2+2y^2-x
$$
$$
g(x,y)=x^3+y^3-9xy+27
$$
$$
h(x,y)=2x^3+y^3-3x^2y-6y
$$

### \underline{Solution}:
We know that a point $(x^*,y^*)$ is critical if $\bigtriangledown f(x^*,y^*)=(0,0)$. After finding a critical point, we can check whether the Hessian Matrix at this point is positive definite or negative definite. If the matrix is positive definite then the point is local minimum. On the other hand, if the Hessian Matrix is negative definite, then it is local maximum.
Now we can start by finging the partial derivative in order to find out the critical point(s)


$$
\partial_xf(x,y) = 2x - 1\quad\text{and}\quad\partial_yf(x,y) = 4y
$$

One can easily check that

$$
\partial_xf(x,y) = 0 \Leftrightarrow x =\frac{1}{2}
$$
$$
\partial_yf(x,y) = 0 \Leftrightarrow y = 0
$$

So function $f$ has one critical point $(x^*,y^*)=(\frac{1}{2},0)$. Moving forward we have to calculate the Hessian matrix in order to check whether the point is local minimum, local maximum or saddle point.We know that

$$
\begin{bmatrix}
\partial_{x^2}^2f(x,y) & \partial_{xy}^2f(x,y)\\
\partial_{yx}^2f(x,y) & \partial_{y^2}^2f(x,y)
\end{bmatrix} = \begin{bmatrix}
2 & 0 \\
0 & 4
\end{bmatrix}
$$

We can easily see that this is a positive definite matrix and as a result the critical point is local minimum. Moving on we have function $g(x,y)$.

$$
\partial_xg(x,y) = 3x^2 - 9y\quad\text{and}\quad\partial_yf(x,y) = 3y^2 -9x
$$

We can solve the equations above like a system, meaning:

$$
\begin{cases}
3x^2 - 9y = 0 \\
3y^2 -9x = 0
\end{cases} \Rightarrow
\begin{cases}
x^2 - 3y = 0 \\
y^2 - 3x = 0
\end{cases} \Rightarrow
\begin{cases}
y = \frac{x^2}{3}\\
y^2 - 3x = 0
\end{cases}\Rightarrow
$$
$$
(\frac{x^2}{3})^2-3x=0\Rightarrow x^4-27x=0 \Rightarrow x(x^3-27)=0 \Rightarrow
$$
$$
x = 0\quad \text{or}\quad x^3 = 27 \Rightarrow
$$
$$
x = 0 \quad \text{or}\quad x = \sqrt[3]{27} \Rightarrow
$$
$$
x=0 \quad \text{or} \quad x = 3
$$

Let's assume that $x = 0$ then by inserting this in the next equation we have that $y = 0$. So we have the first critical point which is $(x^*_1,y^*_2) = (0,0)$.\
On the other hand, let's assume that $x=3$, then we can see that $y = 3$. By those steps, we ended up in a second critical point which is $(x_2^*,y_2^*)=(3,3)$. In order to check and identify what kind of critical points those are, we need to calculate the Hessian determinant in the points we just found. The Hessian matrix can be calculated as follows:

$$
H(x^*,y^*)=\begin{vmatrix}
\partial^2_{x^2} g(x^*,y^*) & \partial_{xy}^2g(x^*,y^*) \\
\partial_{yx}^2g(x^*,y^*) & \partial^2_{y^2} g(x^*,y^*)
\end{vmatrix}=
\begin{vmatrix}
6x^* & -9 \\
-9 & 6y^*
\end{vmatrix}
$$
So for the first critical point, we have the following result

$$
H(0,0)= \begin{vmatrix}
0 & -9\\
-9 & 0
\end{vmatrix}=0\cdot0 -(-9)\cdot(-9)=-81 <0
$$

We ended up that $H(0,0)<0$ meaning that this is a local maximum poitn. Now let us move forward and chech the secotn critical point.

$$
H(3,3)=\begin{vmatrix}
6\cdot3 & -9\\
-9 & 6\cdot3
\end{vmatrix}= \begin{vmatrix}
18 & -9 \\
-9 & 18
\end{vmatrix} =324 -81 = 243 >0
$$

As we can see, $H(3,3) = 243$ is greater than zero. This implies that the critical point is local minimum. The last but not least function is 

$$h(x,y)=2x^3+y^3-3x^2y-6y$$

As you may have already thought, we are going to follow the exact same methodology.

$$
\partial_xh(x,y)=6x^2-6xy\quad \text{and}\quad \partial_yh(x,y)= 3y^2-3x^2-6
$$

In order to find the critical points, we solve the following system.

$$
\begin{cases}
6x^2-6xy = 0\\
3y^2-3x^2-6 = 0
\end{cases} \Rightarrow
\begin{cases}
6x(x-y)=0\\
3y^2-3x^2-6 = 0
\end{cases}\Rightarrow
$$

From the first equation we have that $6x=0\Rightarrow x=0$ or $x=y$.

Initially, let us assume that $x=0$ from the second equation we have that

$$
3y^2-6 = 0 \Leftrightarrow y^2 -2 = 0 \Leftrightarrow y =\pm\sqrt2
$$

Which implies that the critical points obtained are $(x_1^*, y_1^*)=(0,\sqrt2)$ and $(x_2^*, y_2^*)=(0,-\sqrt2)$. Now let us assume that $y = x$ and use this information in the second equation, we have that

$$
3x^2 - 3x^2 -6 =0 \Leftrightarrow -6 = 0
$$

Which is a not possible result. In order to continue and describe the kind of the critical points we have found $(x^*, y^*)=(0,\pm\sqrt2)$ we have to define the Hessian matrix and calculate its determinant for each of the critical point.

$$
H(x^*,y^*)=\begin{vmatrix}
\partial^2_{x^2}h(x^*,y^*) & \partial_{xy}^2h(x^*,y^*)\\
\partial_{yx}^2h(x^*,y^*) & \partial^2_{y^2}h(x^*,y^*)
\end{vmatrix} = \begin{vmatrix}
12x-6y & -6x \\
-6x & 6y
\end{vmatrix}
$$

So moving forward to calculating the Hessian matrix of the critical points we have the following calculations

$$
H(0,\sqrt2) = \begin{vmatrix}
12\cdot0-6\cdot\sqrt2 & -6\cdot0 \\
-6\cdot0 & 6\cdot\sqrt2
\end{vmatrix}=\begin{vmatrix}
-6\sqrt2 & 0\\
0 & 6\sqrt2
\end{vmatrix}= -72 <0
$$

We ended up that $H(0,\sqrt2)=-72<0$ which implies that the critical point is local maximum. 
On the other hand we have that

$$
H(0,-\sqrt2) = \begin{vmatrix}
12\cdot0-6\cdot-\sqrt2 & -6\cdot0 \\
-6\cdot0 & 6\cdot-\sqrt2
\end{vmatrix}=\begin{vmatrix}
6\sqrt2 & 0\\
0 & -6\sqrt2
\end{vmatrix}= -72 <0
$$
Again as the previous critical point we see that the determinant of $H(x_2^*,y_2^*)$ results to $-72$ which less than zero and this implies that the critical point is a local maximum as well.

******

### \underline{Exercise 3}:

Find all the extreme values of the functions

  a. $f(x,y,z)=x^2+y^2+z^2+4yz$ under the constraint that $x+y+z=0$ and $x+y=1$ with the method of Lagrange multipliers \
  b. $f(x_1,x_2,x_3)=2x_1^2-3x_1x_2+x_2^2+x_1x_3-2x_2x_3+3x_3^2$ under the constraint that $x_1+x_2-x_3 = 0$


Figure out if the point is minimal, maximal or a saddle point.

### \underline{Solution}:

  Lagrange multipliers are used to help us solve constrained optimization problems, as we have to face in this exercise. The basic structure of a Lagrange multiplier problem with one constraint and two variables $x,y$ is the following:
  
$$
\mathcal{L}(x,y;\lambda) = f(x,y) + \lambda g(x,y)
$$

where $f(x,y)$ is the function to optimize under the constraint $g(x,y)$, and $\lambda$ is the Lagrange multiplier. In the next step, we set $\nabla\mathcal{L}=\nabla f +\lambda\nabla g=0$ to solve the resulting system of equations.
In our case we have the following:

$$
\mathcal{L}(x,y,z;\lambda_1,\lambda_2) = f(x,y,z) + \lambda_1 g_1(x,y,z) +\lambda_2g_2(x,y,z)\Leftrightarrow
$$
$$
\mathcal{L}(x,y,z;\lambda_1,\lambda_2) = x^2+y^2+z^2+4yz +\lambda_1(x+y+z) +\lambda_2(x+y-1)
$$

The partial derivatives of the Lagrange 

$$
\nabla\mathcal{L}(x,y,z;\lambda_1,\lambda_2) = \nabla f(x,y,z) = \lambda_1 \nabla g_1(x,y,z) + \lambda_2 \nabla g_2(x,y,z)
$$
results in the following system of equations

$$
\begin{cases}
  \nabla_x \mathcal{L}=0 \\
  \nabla_y \mathcal{L}=0 \\
  \nabla_z \mathcal{L}=0 \\
  g_1(x,y,z)=0 \\
  g_2(x,y,z)=0
\end{cases} \Rightarrow \begin{cases}
  2x+\lambda_1+\lambda_2=0 \\
  2y+4z+\lambda_1+\lambda_2=0 \\
  2z+4y+\lambda_1 = 0 \\
  x+y+z=0\\
  x+y-1=0
\end{cases} \Rightarrow 
$$
$$
\begin{cases}
\lambda_2=-2x-2z-4y\\
2y+4z+\lambda_1+\lambda_2=0\\
\lambda_1=-2z-4y\\
x+y+z=0\\
x+y=1
\end{cases}
$$

combining the first three equations, we end up 

$$
\begin{cases}
-6y-2x=0 \\
x+y+z=0 \\
x+y=1
\end{cases}
$$
By solving the last system of equations we end up in the solution

$$
(x^*,y^*,z^* )= (\frac{3}{2}, -\frac{1}{2},-1)
$$

In order to figure out whether this point is minimum, maximum or a saddle point, we can use the determinant of the Hessian matrix. 

$$
H(x^*,y^*,z^*) = \begin{bmatrix}
\partial_{x^2}^2f & \partial_{xy}^2f & \partial_{xz}^2f\\
\partial_{yx}^2f & \partial_{y^2}^2f & \partial_{yz}^2f \\
\partial_{zx}^2f & \partial_{zy}^2f & \partial_{z^2}^2f \\
\end{bmatrix}
$$

We already, have calculated that:

$$
\partial_x(f)(x,y,z) = 2x,\quad \partial\partial_y(f)(x,y,z) = 2y+4z,\quad \partial\partial_z(f)(x,y,z) = 2z+4y
$$

Moving forward we have that: 

$$
|H(x^*,y^*,z^*)| = \begin{vmatrix}
2 & 0 & 0\\
0 & 2 & 4 \\
0 & 4 & 2 \\
\end{vmatrix}
$$

All we now to do is to calculate all the upper-left determinants. We can see that the first argument at posision $1\times1$ is $2>0$. Then as a second step, we need to check the determinant of the submatrix $H_{2\times2}\subset H_{3\times3}$. Hence we see that 

$$
\begin{vmatrix}
2 & 0 \\
0 & 2
\end{vmatrix} = 2\cdot 2 -0\cdot 0 = 4 >0
$$

We see that the determinant is positive as well. Finally, we have that

$$
|H(x^*,y^*,z^*)| = \begin{vmatrix}
2 & 0 & 0\\
0 & 2 & 4 \\
0 & 4 & 2 \\
\end{vmatrix} = 
$$
$$
2\cdot2\cdot2+0\cdot4\cdot0+0\cdot0\cdot4-0\cdot2\cdot0-4\cdot4\cdot2-2\cdot0\cdot0=4-32 =-28<0
$$

As we see, the determinant of the full Hessian matrix is negative. This implies that the Hessian matrix is negative definite and as a result, the point is maximum.

Moving forward to the second part of the exercise we have the following constrained problem.

$$
2x_1^2 − 3x_1x_2 + x_2^2 +x_1x_3 − 2x_2x_3 +3x_3^2
$$
under the constraint
$$
x_1 +x_2 −x_3 =0
$$

Again we need to solve the system of equations created by the partial derivated using the lgrange multipliers.

$$
\mathcal{L}(x_1,x_2,x_3) = \nabla f(x_1,x_2,x_3) + \lambda \nabla g(x_1,x_2,x_3)
$$

$$
\begin{cases}
4x_1 - 3x_2 + x_3 + \lambda = 0 \\
-3x_1 + 2x_2-2x_3 + \lambda = 0 \\
x_1 - 2x_2 + 6x_3 - \lambda = 0 \\
x_1 + x_2 - x_3 = 0
\end{cases}
$$

The steps toward the solution of this system of equations is the following. From the third equation we have that $\lambda = x_1-2x_2+6x_3$ and by place this in the first two equations we have the following system of equations:

$$
\begin{cases}
5x_1-5x_2+7x_3=0 \\
-2x_1+4x_3=0 \\
x_1 + x_2 - x_3 = 0
\end{cases}
$$

With the help of the last equation we have that $x_3 = x_1 + x_2$ and by placing this in the other two equations we have that $x_1 = -2x_2$ and as a result, $x_3 = -x_2$. Show by combining all those findings with the first equation we have that

$$
(x^*,x_2^*,x_3^*) = (0,0,0)
$$
Once again we are going to use the Hessian matrix to decide if this point is maximum, minimum or saddle point. The Hessian Matrix is the 

$$
H(x_1,x_2,x_3)=\begin{bmatrix}
4 & -3 & 1 \\
-3 & 2 & -2 \\
1 & -2 & 6 
\end{bmatrix}
$$
We observe that

$$
4>0
$$
$$
\begin{vmatrix}
4 & -3 \\
-3 & 2
\end{vmatrix} = 4\cdot2 - (-3)\cdot(-3)= 8 - 9 = -1 <0
$$

and finally 

$$
\begin{vmatrix}
4 & -3 & 1 \\
-3 & 2 &-2 \\
1 & -2 & 6
\end{vmatrix} = 
$$
$$
4\cdot2\cdot6 + (-3)\cdot(-2)\cdot1 + 1(-3)\cdot(-2) - 1\cdot2\cdot1 -  (-2)\cdot(-2)\cdot4 -6\cdot(-3)\cdot(-3)
$$

$$
48 + 6 +6 - 2 -16 -54 = -12 < 0
$$

As we have seen, the Hessian matrix is negative definite and as a result, we can say that the point 
$$
(x_1^*,x_2^*,x_3^*)=(0,0,0)
$$

is a maximum.

******

### \underline{Exercise 4}:

Assume you have the following constrained problem:

$$
\begin{aligned}
& \text{maximize}
& & 6x_1 +4x_2 +7x_3 +5x_4 \\
& \text{subject to}
& & x_1 +2x_2 + x_3 +2x_4 \leq 20 \\
&&& 6x_1 +5x_2 +3x_3 +2x_4 \leq 100 \\
&&& 3x_1 +4x_2 +9x_3 +12x_4 \leq 75 \\
&&& x_1,x_2,x_3,x_4 \geq 0
\end{aligned}
$$

  a. Solve the problem (by using R-Programming Language)
  b. Write the dual problem and solve it as well.
  
### \underline{Solution}:

```{r}
f.obj <- c(6,4,7,5)
f.con <- matrix(c(1,2,1,2,6,5,3,2,3,4,9,12,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1), nrow = 7, byrow = TRUE)
f.dir <- c("<=","<=","<=",">=",">=",">=",">=")
f.rhs <- c(20,100,75,0,0,0,0)

result <- lp("max",f.obj,f.con, f.dir,f.rhs)
```

The optimal solution $(x_1^*, x_2^*, x_3^*, x_4^*)$ :
```{r}
result$solution
```

and the optimal value for the objective function is :
```{r}
result$objval
```

Moving forward, the dual problem of the 

$$
\begin{aligned}
& \text{maximize}
& & 6x_1 +4x_2 +7x_3 +5x_4 \\
& \text{subject to}
& & x_1 +2x_2 + x_3 +2x_4 \leq 20 \\
&&& 6x_1 +5x_2 +3x_3 +2x_4 \leq 100 \\
&&& 3x_1 +4x_2 +9x_3 +12x_4 \leq 75 \\
&&& x_1,x_2,x_3,x_4 \geq 0
\end{aligned}
$$
is the following 

$$
\begin{aligned}
& \text{minimize}
& & 20y_1 + 100y_2 +75y_3 \\
& \text{subject to}
& & y_1 + 6y_2 + 3y_3  \geq 6 \\
&&& 2y_1 + 5y_2 + 4y_3 \geq 4 \\
&&& y_1 + 3y_2 + 9y_3 \geq 7 \\
&&& 2y_1 + 2y_2 + 12y_3 \geq 5 \\
&&& y_1,y_2,y_3 \geq 0
\end{aligned}
$$
In order to solve the dual problem we are going to follow the exact same steps as we did for the primal. Meaning, 

```{r}
f.obj <- c(20,100,75)
f.con <- matrix(c(1,6,3,2,5,4,1,3,9,2,2,12,1,0,0,0,1,0,0,0,1), nrow = 7, byrow = TRUE)
f.dir <- c(">=",">=",">=",">=",">=",">=",">=")
f.rhs <- c(6,4,7,5,0,0,0)

result <- lp("min",f.obj,f.con, f.dir,f.rhs)
```

The optimal solution  of the dual is the $(y_1^*, y_2^*, y_3^*)$ :
```{r}
result$solution
```

and the optimal value for the objective function is :
```{r}
result$objval
```