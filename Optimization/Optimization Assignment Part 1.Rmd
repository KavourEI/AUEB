---
title: "Optimization"
author: "Efthymios Ioannis Kavour"
date: '2022-06-24'
output: 
  pdf_document: 
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(latex2exp)
```

### \underline{Exercise 1}:

Assume that :

$$
A = \begin{bmatrix}
3   &  0    &  3 \\
0   &  1    & -2 \\
3   & -2    &  8 \\
\end{bmatrix}
\quad 
B = \begin{bmatrix}
 2  & -1  &  b   \\
-1  &  2  & -1   \\
 b  & -1  &  2   \\
\end{bmatrix}
$$

Is $\textbf{A}$ positively definite? Are there values of $\textit{b}$
that matrix $\textbf{B}$ is positively definite? If yes what are those
values?

### \underline{Solution}:

We know that a symmetrical matrix $M_{k\times k}\quad k =1,\dots,n$ is positively definite if

1. All the eigen values are positive.
2. All the $\textit{n}$ upper left determinants of a $M_{k\times k}$ are positive
3. All the drivers $d_i,\quad\forall i = 1,\dots,n$ in the Gaussian Elimination without interchanging of lines are positive.\

In order to check whether $A$ is positive definite, we are going to calculate all the upper left determinants. As a result we have the following observations. The first term $m_{1\times 1}$ is positive.

$$
3 > 0
$$

Furthermore, we can see that the next $\textit{left-upper}$ determinant is the determinant of the $2\times 2$ submatrix, as shown below, which is positive as well.

$$
\begin{vmatrix}
3 & 0 \\
0 & 1
\end{vmatrix} = 3 > 0
$$
Finally what is left is the determinant of the full $3\times 3$ matrix $A$ which as shown below, positive.


$$
\begin{vmatrix}
3   &  0    &  3    \\
0   &  1    & -2    \\
3   & -2    &  8    
\end{vmatrix} = \\
$$
$$
3\cdot1\cdot8+0\cdot(-2)\cdot3+3\cdot0\cdot(-2)-3\cdot1\cdot3-(-2)\cdot(-2)\cdot3-8\cdot0\cdot0=\\
$$

$$
24+0+0-9-12-0=3>0
$$

In conclusion, we can see that matrix $A$ is $\textbf{positive define}$. We are going to follow the exact same methodology in order to answer to the second part of this exercise. Initially we observe that $2>0$ and as a result we move forward and calculate the next determinant of the upper-left submatrix $M_{2\times2}$.

$$
\begin{vmatrix}
 2 &  -1 \\
-1 & 2 
\end{vmatrix} = 2\cdot 2 - (-1)\cdot (-1)= 4 - 1 = 3 >0
$$ 
The determinant of the submatrix is a positive number. What is left is to calculate the determinant of the full initial matrix, containing the unknown $b$. What we need is $B$ to be a positive definite. This means that: 

$$
\begin{vmatrix}
 2  & -1  &  b   \\
-1  &  2  & -1   \\
 b  & -1  &  2  
\end{vmatrix}=
$$

$$
2\cdot 2\cdot 2 + (-1)\cdot (-1)\cdot b + b\cdot (-1)\cdot (-1) - b \cdot 2\cdot b- (-1)\cdot (-1)\cdot 2 - 2 \cdot (-1)\cdot (-1)=
$$

$$
8+b+b-2b^2-2-2=-2b^2+2b+4
$$

As a result we have to find all those $b$ that the equation we ended up. If we follow the usual steps of solving a second order equation we have that:

$$
−2b^2+2b+4=2(−b−1)(b−2)
$$
which means that the $b$ that make this equation equal to zero are $b=-1$ and $b=2$. We know that the equation is going to be positive $\forall b \in (-1,2)$ and negative $\forall b \in (-\infty,-1)\cup(2,\infty)$. This is something one can observe in the following graph.

```{r}
f1 <- function(x){
        return(-2*x^2+2*x+4)
}

curve(expr = f1, from = -2, to = 3)
points(x = c(-1,2), y = c(0,0), col = 'red')
abline(h = 0, lty = 2, col = 'red')
title(main = TeX(r'(\textbf{Equation} : $-2x^2+2x+4$)'))
```

As a result the solution is the following
$$
B\text{ positive-definite} \Leftrightarrow \forall b \in (-1,2)
$$

******

### \underline{Exercise 2}:

Find all the critical points and say whether they are local minimum, local maximum or saddle points, of the following functions:

$$
f(x,y)=x^2+2y^2-x
$$
$$
g(x,y)=x^3+y^3-9xy+27
$$
$$
h(x,y)=2x^3+y^3-3x^2y-6y
$$

### \underline{Solution}:
We know that a point $(x^*,y^*)$ is critical if $\bigtriangledown f(x^*,y^*)=(0,0)$. After finding a critical point, we can check whether the Hessian Matrix at this point is positive definite or negative definite. If the matrix is positive definite then the point is local minimum. On the other hand, if the Hessian Matrix is negative definite, then it is local maximum.
Now we can start by finging the partial derivative in order to find out the critical point(s)


$$
\partial_xf(x,y) = 2x - 1\quad\text{and}\quad\partial_yf(x,y) = 4y
$$

One can easily check that

$$
\partial_xf(x,y) = 0 \Leftrightarrow x =\frac{1}{2}
$$
$$
\partial_yf(x,y) = 0 \Leftrightarrow y = 0
$$

So function $f$ has one critical point $(x^*,y^*)=(\frac{1}{2},0)$. Moving forward we have to calculate the Hessian matrix in order to check whether the point is local minimum, local maximum or saddle point.We know that

$$
\begin{bmatrix}
\frac{\partial f}{\partial^2x}(x,y) & \frac{\partial f}{\partial x\partial y}(x,y)\\
\frac{\partial f}{\partial y\partial x}(x,y) & \frac{\partial f}{\partial^2y}(x,y)
\end{bmatrix} = \begin{bmatrix}
2 & 0 \\
0 & 4
\end{bmatrix}
$$

We can easily see that this is a positive definite matrix and as a result the critical point is local minimum. Moving on we have function $g(x,y)$.

$$
\partial_xg(x,y) = 3x^2 - 9y\quad\text{and}\quad\partial_yf(x,y) = 3y^2 -9x
$$

We can solve the equations above like a system, meaning:

$$
\begin{cases}
3x^2 - 9y = 0 \\
3y^2 -9x = 0
\end{cases} \Rightarrow
\begin{cases}
x^2 - 3y = 0 \\
y^2 - 3x = 0
\end{cases} \Rightarrow
\begin{cases}
y = \frac{x^2}{3}\\
y^2 - 3x = 0
\end{cases}\Rightarrow
$$
$$
(\frac{x^2}{3})^2-3x=0\Rightarrow x^4-27x=0 \Rightarrow x(x^3-27)=0 \Rightarrow
$$
$$
x = 0\quad \text{or}\quad x^3 = 27 \Rightarrow
$$
$$
x = 0 \quad \text{or}\quad x = \sqrt[3]{27} \Rightarrow
$$
$$
x=0 \quad \text{or} \quad x = 3
$$

Let's assume that $x = 0$ then by inserting this in the next equation we have that $y = 0$. So we have the first critical point which is $(x^*_1,y^*_2) = (0,0)$.\
On the other hand, let's assume that $x=3$, then we can see that $y = 3$. By those steps, we ended up in a second critical point which is $(x_2^*,y_2^*)=(3,3)$. In order to check and identify what kind of critical points those are, we need to calculate the Hessian determinant in the points we just found. The Hessian matrix can be calculated as follows:

$$
H(x^*,y^*)=\begin{vmatrix}
\partial^2_x g(x^*,y^*) & \partial_{xy}g(x^*,y^*) \\
\partial_{yx}g(x^*,y^*) & \partial^2_y g(x^*,y^*)
\end{vmatrix}=
\begin{vmatrix}
6x^* & -9 \\
-9 & 6y^*
\end{vmatrix}
$$
So for the first critical point, we have the following result

$$
H(0,0)= \begin{vmatrix}
0 & -9\\
-9 & 0
\end{vmatrix}=0\cdot0 -(-9)\cdot(-9)=-81 <0
$$

We ended up that $H(0,0)<0$ meaning that this is a local maximum poitn. Now let us move forward and chech the secotn critical point.

$$
H(3,3)=\begin{vmatrix}
6\cdot3 & -9\\
-9 & 6\cdot3
\end{vmatrix}= \begin{vmatrix}
18 & -9 \\
-9 & 18
\end{vmatrix} =324 -81 = 243 >0
$$

As we can see, $H(3,3) = 243$ is greater than zero. This implies that the critical point is local minimum. The last but not least function is 

$$h(x,y)=2x^3+y^3-3x^2y-6y$$

As you may have already thought, we are going to follow the exact same methodology.

$$
\partial_xh(x,y)=6x^2-6xy\quad \text{and}\quad \partial_yh(x,y)= 3y^2-3x^2-6
$$

In order to find the critical points, we solve the following system.

$$
\begin{cases}
6x^2-6xy = 0\\
3y^2-3x^2-6 = 0
\end{cases} \Rightarrow
\begin{cases}
6x(x-y)=0\\
3y^2-3x^2-6 = 0
\end{cases}\Rightarrow
$$

From the first equation we have that $6x=0\Rightarrow x=0$ or $x=y$.

Initially, let us assume that $x=0$ from the second equation we have that

$$
3y^2-6 = 0 \Leftrightarrow y^2 -2 = 0 \Leftrightarrow y =\pm\sqrt2
$$

Which implies that the critical points obtained are $(x_1^*, y_1^*)=(0,\sqrt2)$ and $(x_2^*, y_2^*)=(0,-\sqrt2)$. Now let us assume that $y = x$ and use this information in the second equation, we have that

$$
3x^2 - 3x^2 -6 =0 \Leftrightarrow -6 = 0
$$

Which is a not possible result. In order to continue and describe the kind of the critical points we have found $(x^*, y^*)=(0,\pm\sqrt2)$ we have to define the Hessian matrix and calculate its determinant for each of the critical point.

$$
H(x^*,y^*)=\begin{vmatrix}
\partial^2_xh(x^*,y^*) & \partial_{xy}h(x^*,y^*)\\
\partial_{yx}h(x^*,y^*) & \partial^2_yh(x^*,y^*)
\end{vmatrix} = \begin{vmatrix}
12x-6y & -6x \\
-6x & 6y
\end{vmatrix}
$$

So moving forward to calculating the Hessian matrix of the critical points we have the following calculations

$$
H(0,\sqrt2) = \begin{vmatrix}
12\cdot0-6\cdot\sqrt2 & -6\cdot0 \\
-6\cdot0 & 6\cdot\sqrt2
\end{vmatrix}=\begin{vmatrix}
-6\sqrt2 & 0\\
0 & 6\sqrt2
\end{vmatrix}= -72 <0
$$

We ended up that $H(0,\sqrt2)=-72<0$ which implies that the critical point is local maximum. 
On the other hand we have that

$$
H(0,-\sqrt2) = \begin{vmatrix}
12\cdot0-6\cdot-\sqrt2 & -6\cdot0 \\
-6\cdot0 & 6\cdot-\sqrt2
\end{vmatrix}=\begin{vmatrix}
6\sqrt2 & 0\\
0 & -6\sqrt2
\end{vmatrix}= -72 <0
$$
Again as the previous critical point we see that the determinant of $H(x_2^*,y_2^*)$ results to $-72$ which less than zero and this implies that the critical point is a local maximum as well.

******

### \underline{Exercise 3}:

Find all the 


### \underline{Solution}: